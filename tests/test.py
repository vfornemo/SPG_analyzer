import numpy as np
from pyscf import gto
from pyscf.symm import *

# input molecule in pyscf format
mol = gto.Mole()
mol.atom = '''
C    1.3940    0.0000    0.0000 
C    0.6970   -1.2072    0.0000 
C   -0.6970   -1.2072    0.0000 
C   -1.3940    0.0000    0.0000 
C   -0.6970    1.2072    0.0000 
C    0.6970    1.2072    0.0000 
H    2.4784    0.0000    0.0000 
H    1.2392   -2.1464    0.0000 
H   -1.2392   -2.1464    0.0000 
H   -2.4784    0.0000    0.0000 
H   -1.2392    2.1464    0.0000 
H    1.2392    2.1464    0.0000 
'''

mol.basis = 'sto-3g'
mol.build()

atom = [['C', (1.3940, 0.0000, 0.0000)],
    ['C', (0.6970, -1.2072, 0.0000)],
    ['C', (-0.6970, -1.2072, 0.0000)],
    ['C', (-1.3940, 0.0000, 0.0000)],
    ['C', (-0.6970, 1.2072, 0.0000)],
    ['C', (0.6970, 1.2072, 0.0000)],
    ['H', (2.4784, 0.0000, 0.0000)],
    ['H', (1.2392, -2.1464, 0.0000)],
    ['H', (-1.2392, -2.1464, 0.0000)],
    ['H', (-2.4784, 0.0000, 0.0000)],
    ['H', (-1.2392, 2.1464, 0.0000)],
    ['H', (1.2392, 2.1464, 0.0000)]]

atom2 = [['B', (0.4422, 0.6086, 0.0000)],
         ['H', (1.0251, 1.1916, 0.0000)],
         ['B', (0.7154, -0.2324, 0.0000)],
         ['H', (1.4294, -0.6447, 0.0000)],
         ['B', (0.0000, -0.7523, 0.0000)],
         ['H', (-0.2134, -1.5485, 0.0000)],
         ['B', (-0.7154, -0.2324, 0.0000)],
         ['H', (-1.5118, -0.4458, 0.0000)],
         ['B', (-0.4422, 0.6086, 0.0000)],
         ['H', (-0.8544, 1.3226, 0.0000)],
         ['B', (0.0000, 0.0000, 0.0000)],
         ['H', (0.7969, 0.2135, 0.0000)],
         ['B', (0.7671, -1.0559, 0.0000)],
         ['H', (1.3504, -1.6392, 0.0000)],
         ['B', (-0.7671, -1.0559, 0.0000)],
         ['H', (-1.3504, -1.6392, 0.0000)],
         ['B', (-1.2413, 0.4033, 0.0000)],
         ['H', (-2.0381, 0.6169, 0.0000)],
         ['B', (0.0000, 1.3051, 0.0000)],
         ['H', (0.0000, 2.1301, 0.0000)],
         ['B', (1.2413, 0.4033, 0.0000)],
         ['H', (2.0381, 0.6169, 0.0000)],
         ['B', (0.0000, 0.3656, 0.0000)],
         ['H', (0.5483, 1.3033, 0.0000)]]

atom3 = [['C', (1.5887, -1.4186, 0.4565)],
             ['C', (1.8446, 1.0831, 0.4112)],
             ['C', (-0.6051, -1.9953, -0.6303)],
             ['C', (0.5564, 1.1759, -1.7472)],
             ['C', (0.1910, -2.0526, 0.7036)],
             ['C', (0.3793, 0.0000, 2.1450)],
             ['C', (1.7050, -0.1500, 1.3473)],
             ['C', (-1.8446, -1.0831, -0.4112)],
             ['C', (1.6564, -0.9695, -1.0302)],
             ['C', (-1.8145, -0.5767, 1.0582)],
             ['C', (0.3005, -1.3259, -1.7019)],
             ['C', (1.8145, 0.5767, -1.0582)],
             ['C', (0.6051, 1.9953, 0.6303)],
             ['C', (-0.3793, -0.0000, -2.1450)],
             ['C', (-1.7050, 0.1500, -1.3473)],
             ['C', (-1.5887, 1.4186, -0.4565)],
             ['C', (-0.3005, 1.3259, 1.7019)],
             ['C', (-0.1910, 2.0526, -0.7036)],
             ['C', (-0.5564, -1.1759, 1.7472)],
             ['C', (-1.6564, 0.9695, 1.0302)],
             ['H', (2.3817, -2.1268, 0.6843)],
             ['H', (2.7653, 1.6238, 0.6164)],
             ['H', (0.8342, 1.7628, -2.6193)],
             ['H', (0.5686, 0.0000, 3.2157)],
             ['H', (-0.9071, -2.9913, -0.9450)],
             ['H', (-2.7654, -1.6238, -0.6164)],
             ['H', (0.2864, -3.0772, 1.0548)],
             ['H', (2.7203, 0.8645, -1.5864)],
             ['H', (0.4505, -1.9878, -2.5514)],
             ['H', (0.9072, 2.9913, 0.9450)],
             ['H', (-2.7203, -0.8645, 1.5864)],
             ['H', (2.5561, -0.2249, 2.0198)],
             ['H', (-0.2864, 3.0772, -1.0548)],
             ['H', (2.4832, -1.4534, -1.5444)],
             ['H', (-2.3817, 2.1268, -0.6843)],
             ['H', (-0.5686, -0.0000, -3.2157)],
             ['H', (-2.5561, 0.2249, -2.0198)],
             ['H', (-0.4505, 1.9878, 2.5514)],
             ['H', (-2.4832, 1.4535, 1.5444)],
             ['H', (-0.8342, -1.7628, 2.6193)]]


gpname, orig, axes = detect_symm(atom)
print(gpname, orig, axes)
atom = shift_atom(atom, orig, axes)
print(gpname, symm_identical_atoms(subgroup(gpname, axes)[0], atom))


gpname, orig, axes = detect_symm(atom2)
print(gpname, orig, axes)
atom2 = shift_atom(atom2, orig, axes)
print(gpname, symm_identical_atoms(subgroup(gpname, axes)[0], atom2))

gpname, orig, axes = detect_symm(atom3)
print(gpname, orig, axes)
atom3 = shift_atom(atom3, orig, axes)
print(gpname, symm_identical_atoms(subgroup(gpname, axes)[0], atom3))